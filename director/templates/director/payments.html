{% extends "main/base.html" %}

{% block title_h1 %}Контроль расходов{% endblock %}
{% block breadcrumb_buttons %}
    <button onclick="location.href='{% url 'director:payment_create' %}'" type="button" class="btn btn-secondary mr-2 d-none d-none d-lg-block pd-t-6-force pd-b-5-force" >
    <i data-feather="file-plus" class="wd-16 mr-2"></i>Создать платеж</button>
    <button onclick="location.href='{% url 'common:payment_category_create' %}'" type="button" class="btn btn-secondary mr-2 d-none d-none d-lg-block pd-t-6-force pd-b-5-force" >
    <i data-feather="file-plus" class="wd-16 mr-2"></i>Создать категорию</button>
{% endblock %}

{% block body_content %}
                     <!-- Filtering FooTable Start -->
                     <!--================================-->
                     <div class="col-md-12 col-lg-12">
                        <div class="card mg-b-30">

                           <div class="card-body pd-0">

                                            <div class="row">
                                                <div class="col-6">
                                                       <canvas id="myChart9" height="120"></canvas>
                                                </div>
                                            </div>

                                           <div class="row">
                                             <div class="mg-20 form-inline wd-100p">

                                                <div class="col-sm-6">
                                                   <div class="form-group">
                                                       <div class="d-flex align-items-center">
                                                            <button id="dashboardDate" name="DatePick" class="btn btn-default dropdown-toggle mr-2 d-none d-md-block pd-y-8-force"></button>
                                                            <span id="startDateY" hidden> {{ startDate.0 }}</span>
                                                            <span id="startDateM" hidden> {{ startDate.1 }}</span>
                                                            <span id="startDateD" hidden> {{ startDate.2 }}</span>
                                                            <span id="endDateY" hidden> {{ endDate.0 }}</span>
                                                            <span id="endDateM" hidden> {{ endDate.1 }}</span>
                                                            <span id="endDateD" hidden> {{ endDate.2 }}</span>
                                                       </div>
                                                      <select id="foo-filter-status" class="custom-select">
                                                         <option value="">Показать все</option>
                                                          {% for q in category %}
                                                            <option value="{{q.name}}">{{q.name}}</option>
                                                          {% endfor %}

                                                      </select>
                                                   </div>
                                                </div>
                                                <div class="col-sm-6">
                                                   <div class="form-group ft-right">
                                                      <input id="foo-search" type="text" placeholder="Поиск" class="form-control" autocomplete="off">
                                                   </div>
                                                </div>
                                             </div>
                                          </div>
                                          <table id="foo-filtering" class="table table-bordered table-hover toggle-circle" data-page-size="50">
                                              <thead class="tx-10 tx-uppercase">
                                                 <tr>
                                                    <th>ID</th>
                                                     <th>Дата</th>
                                                     <th>Заказ</th>
                                                     <th>Пользователь</th>
                                                    <th>Категория</th>
                                                    <th>Тип оплаты</th>
                                                     <th>Сумма</th>
                                                     <th>Документ</th>
                                                    <th class="tx-right">Действия</th>
                                                 </tr>
                                              </thead>


                                                 <tbody>
                                                    {% for q in orders %}
                                                            <tr class="table table-bordered table-hover">
                                                                <td><a href="">{{q.id}}</a></td>
                                                                <td>{{q.date_created|date:'d.m.Y H:i'}}</td>
                                                                <td>{{q.order.number}}</td>
                                                                <td>{{q.user.get_full_name}}</td>
                                                                <td><span class="badge badge-dark">{{ q.category }}</span></td>
                                                                <td>{{ q.get_type_money_display }}</td>
                                                                <td>{{ q.price }}</td>
                                                                <td>{{ q.receipt }}</td>
                                                                <td class="tx-right">
                                                                    <a href=""  title="" data-toggle="tooltip" data-original-title="Изменить"><i data-feather="edit-3" class="wd-16 mr-2"></i></a>
                                                                    <a href="" title="" data-toggle="tooltip" data-original-title="Удалить"><i data-feather="x" class="wd-16"></i></a>
                                                                </td>
                                                            </tr>
                                                    {% endfor %}
                                                 </tbody>
                                                  <tfoot>
                                                    <tr>
                                                       <td colspan="5">
                                                          <div class="ft-right">
                                                             <ul class="pagination"></ul>
                                                          </div>
                                                       </td>
                                                    </tr>
                                                 </tfoot>

                                          </table>



                           </div>
                        </div>

                     </div>
                     <!--/ Filtering FooTable End -->


 <script src="/static/main/assets/plugins/chartjs/chartjs.js"></script>
 <script src="/static/main/assets/plugins/chartjs/chartjs-active.js"></script>
 <script>
    var ctx = document.getElementById('myChart9').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'doughnut',// bar, horizontalBar, pie, line, doughnut, radar, polarArea

        data: {
            labels: {{cat_label|safe}},
            datasets: [{
                data: {{cat_price|safe}},
                backgroundColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ]
            }]
        },
        options: {
            title: {
                display: true,
                position: 'top',
                text: 'Статистика по расходам за период {{ period }}',
            },
            legend: {
                display: true,
                position: 'right',
                labels: {
                    fontColor: '#000'
                }
            }

        }


    });

  </script>
{% endblock %}

